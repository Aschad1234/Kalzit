$uiLoginForm = ($onLoginAttempt) fun {
	$nameField = $nameInput uiTextfieldVariableOnchange {}.
	$passwordInput = "". $passwordInputRef = reference: $passwordInput.
	$passwordField = {passwordInputRef = x} uiPasswordOnchange passwordInput.
	
	$views =
		[uiText: strings: $username];
		[@(percentWidth: 100) nameField];
		[uiText: strings: $password];
		[@(percentWidth: 100) passwordField];
		[@center {
			($response fun {
				!if ("0" eq first: response) {
					$calcitSession storageSaveString second: response.
					$calcitUserName storageSaveString nameInput.
					popupMessage: strings: $loginSuccess.
					onLoginAttempt: true.
				}. else {
					popupMessage: second: response.
					onLoginAttempt: false.
				}.
			}) serviceLoginUserAsync nameInput;passwordInput.
		} uiButton strings: $login];
		[@(emHeight 2) uiContainer: void];
		[@centerText uiText: strings: $optionsSeparator];
		[@center {openSubApp: "register"} uiButton strings: $registerButton].
		
	uiContainer: views
}.

$uiRegisterForm = () fun {
	$nameField = $nameInput uiTextfieldVariableOnchange {}.
	$passwordInput = "". $passwordInputRef = reference: $passwordInput.
	$passwordField = {passwordInputRef = x} uiPasswordOnchange passwordInput.
	
	$views =
		[uiText: strings: $username];
		[@(percentWidth: 100) nameField];
		[uiText: strings: $password];
		[@(percentWidth: 100) passwordField];
		[@center {
			($response fun {
				!if ("0" eq first: response) {
					popupMessage: strings: $registrationSuccess.
	        	}. else {
	        		popupMessage: second: response
	        	}.
			}) serviceRegisterUserAsync nameInput;passwordInput.
        } uiButton strings: $register].
		
	uiContainer: views
}
